<div class="container">
  <div fxLayout="column">
    <h1 class="mat-h1">文档</h1>

    <div fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxFlex fxLayoutGap.gt-sm="8px">
      <div fxFlex.gt-sm="67" fxFlex>
        <mat-card class="document-card">
          <mat-card-header>
            <mat-card-title>
              上传
            </mat-card-title>
          </mat-card-header>
          <mat-card-content class="document-card-content">
            <form [formGroup]="documentUploadForm" novalidate (ngSubmit)="onSubmit()">
              <div fxLayout="column" fxLayoutAlign="space-around stretch" fxLayoutGap="0px">

                <!-- Resource Type -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">lock</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>资源类型</mat-label>
                    <mat-select required formControlName="resourceType"
                      (selectionChange)="resourceTypeChange($event.value)">
                      <mat-option *ngFor="let resourceType of resourceTypes" [value]="resourceType">
                        {{resourceType}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="documentUploadForm.controls['resourceType'].hasError('required')">
                      资源类型为<strong>必填项</strong>
                    </mat-error>
                  </mat-form-field>
                </div>

                <!-- Document Type -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">description</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>文档类型</mat-label>
                    <mat-select required formControlName="documentType">
                      <mat-option *ngFor="let documentType of documentTypes" [value]="documentType">
                        {{documentType}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="documentUploadForm.controls['documentType'].hasError('required')">
                      文档类型为<strong>必填项</strong>
                    </mat-error>
                  </mat-form-field>
                  <div class="misc-margin">
                    <mat-checkbox fxFlex="auto" formControlName="isDocumentTypePublic">可公开</mat-checkbox>
                  </div>
                </div>

                <!-- Name -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">title</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>名称</mat-label>
                    <input matInput required formControlName="name">
                    <mat-error *ngIf="documentUploadForm.controls['name'].hasError('required')">
                      名称为<strong>必填项</strong>
                    </mat-error>
                  </mat-form-field>
                  <div class="misc-margin">
                    <mat-checkbox fxFlex="auto" formControlName="isNamePublic">可公开</mat-checkbox>
                  </div>
                </div>

                <!-- Entity Asset ID -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">pin</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>实体资产 ID</mat-label>
                    <input matInput placeholder="选填" formControlName="entityAssetId">
                  </mat-form-field>
                  <div class="misc-margin">
                    <mat-checkbox fxFlex="auto" formControlName="isEntityAssetIdPublic">可公开</mat-checkbox>
                  </div>
                </div>

                <!-- Preceding Document ID -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">pin</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>前序文档 ID</mat-label>
                    <input matInput placeholder="选填" formControlName="precedingDocumentId">
                  </mat-form-field>
                  <div class="misc-margin">
                    <button mat-stroked-button type="button" fxFlex="auto"
                      (click)="checkPrecedingDocumentId()">检测</button>
                  </div>
                  <div class="misc-margin">
                    <mat-checkbox fxFlex="auto" formControlName="isPrecedingDocumentIdPublic">可公开</mat-checkbox>
                  </div>
                </div>

                <!-- Head Document ID -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">pin</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>头文档 ID</mat-label>
                    <input matInput placeholder="选填" formControlName="headDocumentId">
                  </mat-form-field>
                  <div class="misc-margin">
                    <button mat-stroked-button type="button" fxFlex="auto" (click)="checkHeadDocumentId()">检测</button>
                  </div>
                  <div class="misc-margin">
                    <mat-checkbox fxFlex="auto" formControlName="isHeadDocumentIdPublic">可公开</mat-checkbox>
                  </div>
                </div>

                <!-- Contents -->
                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">cloud_upload</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>内容</mat-label>
                    <input matInput required placeholder="文件名" [value]="filename" formControlName="contents">
                    <mat-error *ngIf="documentUploadForm.controls['contents'].hasError('required')">
                      内容为<strong>必填项</strong>
                    </mat-error>
                  </mat-form-field>
                  <div class="misc-margin">
                    <input #fileInput hidden="true" type="file" onclick="this.value=null"
                      (change)="fileInputChange($event)">
                    <button mat-stroked-button color="primary" type="button" fxFlex="auto"
                      (click)="fileInput.click()">浏览</button>
                  </div>
                </div>

                <!-- Policy -->
                <div *ngIf="documentUploadForm.get('resourceType')?.value !== this.resourceTypes[0]" fxLayout="row"
                  fxLayoutAlign="space-between center" fxLayoutGap="8px">
                  <div class="misc-margin">
                    <mat-icon fxFlex="auto">policy</mat-icon>
                  </div>
                  <mat-form-field appearance="outline" fxFlex="auto">
                    <mat-label>策略</mat-label>
                    <input matInput required formControlName="policy">
                    <mat-error *ngIf="documentUploadForm.controls['policy'].hasError('required')">
                      策略为<strong>必填项</strong>
                    </mat-error>
                  </mat-form-field>
                  <div class="misc-margin">
                    <mat-icon matTooltip='可用关键词：&#13;
                      DeptType, DeptLevel, DeptName, SuperDeptName&#13;
                      例子：&#13;
                      (DeptType == "Dev" && DeptLevel == 2)' matTooltipClass="help-tooltip" fxFlex="auto">help
                    </mat-icon>
                  </div>
                </div>

                <div style="height: 10px;"></div>

                <!-- Reset & Upload -->
                <div class="document-card-margin" fxLayout="row" fxLayoutAlign="space-around center" fxLayoutGap="8px">
                  <button mat-button color="warn" type="button" (click)="documentUploadResetButtonClick()">重置</button>
                  <button mat-raised-button color="primary" type="submit">上传</button>
                </div>

              </div>
            </form>
          </mat-card-content>
        </mat-card>
      </div>

      <div fxFlex.gt-sm="33" fxFlex>
        <mat-card class="document-card">
          <mat-card-header>
            <mat-card-title>
              说明
            </mat-card-title>
          </mat-card-header>
          <mat-card-content class="document-card-content">

            <mat-label class="instruction">{{instruction}}</mat-label>

          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>
